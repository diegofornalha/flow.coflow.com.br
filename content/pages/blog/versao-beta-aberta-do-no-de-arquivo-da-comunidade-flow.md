---
layout: PostLayout
metaTitle: VersÃ£o beta aberta do nÃ³ de arquivo da comunidade Flow
addTitleSuffix: true
metaTags: []
title: VersÃ£o beta aberta do nÃ³ de arquivo da comunidade Flow
colors: colors-a
date: '2022-12-07'
excerpt: >-
  O nÃ³ de arquivo Ã© um tipo de nÃ³ da cadeia de blocos Flow que Ã© responsÃ¡vel por
  armazenar e indexar o protocolo e o estado de execuÃ§Ã£o da cadeia. Ele permite
  consultas somente leitura, como a execuÃ§Ã£o de scripts que precisam de acesso a
  valores do registro do estado de execuÃ§Ã£o. Ele Ã© projetado para fornecer uma
  soluÃ§Ã£o escalÃ¡vel e eficiente para acessar o histÃ³rico do estado de execuÃ§Ã£o
  da cadeia Flow, permitindo a consulta de detalhes da conta e execuÃ§Ã£o de
  scripts em qualquer bloco desde o inÃ­cio do spork atual atÃ© o Ãºltimo bloco
  selado. O nÃ³ de arquivo Ã© Ãºtil para dApps que precisam de acesso a dados
  histÃ³ricos, ferramentas de anÃ¡lise e auditoria em cadeia que precisam de
  acesso a dados histÃ³ricos e nÃ³s diferentes para recuperaÃ§Ã£o de dados. Ele Ã©
  diferente de outros tipos de nÃ³s, como o nÃ³ de acesso e o nÃ³ observador, que
  sÃ£o responsÃ¡veis por fornecer acesso ao estado atual da cadeia e aos dados do
  protocolo, respectivamente.
featuredImage:
  type: ImageBlock
  url: >-
    /images/VersÃ£o beta aberta do nÃ³ de arquivo da comunidade Flow
    Diegofornalha.png
  altText: VersÃ£o beta aberta do nÃ³ de arquivo da comunidade Flow
  caption: >-
    O nÃ³ de arquivo Ã© um tipo de nÃ³ da cadeia de blocos Flow que Ã© responsÃ¡vel
    por armazenar e indexar o protocolo e o estado de execuÃ§Ã£o da cadeia. Ele
    permite consultas somente leitura, como a execuÃ§Ã£o de scripts que precisam
    de acesso a valores do registro do estado de execuÃ§Ã£o. Ele Ã© projetado para
    fornecer uma soluÃ§Ã£o escalÃ¡vel e eficiente para acessar o histÃ³rico do
    estado de execuÃ§Ã£o da cadeia Flow, permitindo a consulta de detalhes da
    conta e execuÃ§Ã£o de scripts em qualquer bloco desde o inÃ­cio do spork atual
    atÃ© o Ãºltimo bloco selado. O nÃ³ de arquivo Ã© Ãºtil para dApps que precisam de
    acesso a dados histÃ³ricos, ferramentas de anÃ¡lise e auditoria em cadeia que
    precisam de acesso a dados histÃ³ricos e nÃ³s diferentes para recuperaÃ§Ã£o de
    dados. Ele Ã© diferente de outros tipos de nÃ³s, como o nÃ³ de acesso e o nÃ³
    observador, que sÃ£o responsÃ¡veis por fornecer acesso ao estado atual da
    cadeia e aos dados do protocolo, respectivamente.
media:
  type: ImageBlock
  url: >-
    /images/VersÃ£o beta aberta do nÃ³ de arquivo da comunidade Flow
    Diegofornalha.png
  altText: VersÃ£o beta aberta do nÃ³ de arquivo da comunidade Flow
  caption: >-
    O nÃ³ de arquivo Ã© um tipo de nÃ³ da cadeia de blocos Flow que Ã© responsÃ¡vel
    por armazenar e indexar o protocolo e o estado de execuÃ§Ã£o da cadeia. Ele
    permite consultas somente leitura, como a execuÃ§Ã£o de scripts que precisam
    de acesso a valores do registro do estado de execuÃ§Ã£o. Ele Ã© projetado para
    fornecer uma soluÃ§Ã£o escalÃ¡vel e eficiente para acessar o histÃ³rico do
    estado de execuÃ§Ã£o da cadeia Flow, permitindo a consulta de detalhes da
    conta e execuÃ§Ã£o de scripts em qualquer bloco desde o inÃ­cio do spork atual
    atÃ© o Ãºltimo bloco selado. O nÃ³ de arquivo Ã© Ãºtil para dApps que precisam de
    acesso a dados histÃ³ricos, ferramentas de anÃ¡lise e auditoria em cadeia que
    precisam de acesso a dados histÃ³ricos e nÃ³s diferentes para recuperaÃ§Ã£o de
    dados. Ele Ã© diferente de outros tipos de nÃ³s, como o nÃ³ de acesso e o nÃ³
    observador, que sÃ£o responsÃ¡veis por fornecer acesso ao estado atual da
    cadeia e aos dados do protocolo, respectivamente.
bottomSections: []
metaDescription: >-
  O nÃ³ de arquivo Ã© um tipo de nÃ³ da cadeia de blocos Flow que Ã© responsÃ¡vel por
  armazenar e indexar o protocolo e o estado de execuÃ§Ã£o da cadeia. Ele permite
  consultas somente leitura, como a execuÃ§Ã£o de scripts que precisam de acesso a
  valores do registro do estado de execuÃ§Ã£o. Ele Ã© projetado para fornecer uma
  soluÃ§Ã£o escalÃ¡vel e eficiente para acessar o histÃ³rico do estado de execuÃ§Ã£o
  da cadeia Flow, permitindo a consulta de detalhes da conta e execuÃ§Ã£o de
  scripts em qualquer bloco desde o inÃ­cio do spork atual atÃ© o Ãºltimo bloco
  selado. O nÃ³ de arquivo Ã© Ãºtil para dApps que precisam de acesso a dados
  histÃ³ricos, ferramentas de anÃ¡lise e auditoria em cadeia que precisam de
  acesso a dados histÃ³ricos e nÃ³s diferentes para recuperaÃ§Ã£o de dados. Ele Ã©
  diferente de outros tipos de nÃ³s, como o nÃ³ de acesso e o nÃ³ observador, que
  sÃ£o responsÃ¡veis por fornecer acesso ao estado atual da cadeia e aos dados do
  protocolo, respectivamente.
socialImage: >-
  /images/VersÃ£o beta aberta do nÃ³ de arquivo da comunidade Flow
  Diegofornalha.png
author: content/data/team/hilary-ouse.json
---
Temos o prazer de anunciar o Open Beta do nÃ³ de arquivo da comunidade Flow.Â O nÃ³ de arquivo fornece uma maneira escalÃ¡vel e eficiente de acessar o histÃ³rico do estado de execuÃ§Ã£o do protocolo da flow\*\* para o spork atual.Â Ele pode ser usado para consultar detalhes da conta e executar scripts em qualquer bloco desde o inÃ­cio do spork atual atÃ© o Ãºltimo bloco selado usando a API de acesso gRPC.

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#o-que-%C3%A9-um-n%C3%B3-de-arquivo)**O que Ã© um nÃ³ de arquivo?**

[A arquitetura de vÃ¡rios nÃ³s da](https://flow.com/primer#primer-multinode)Â FlowÂ fornece dimensionamento Ã  prova de futuro, separando o consenso da execuÃ§Ã£o e tendo alguns nÃ³s de execuÃ§Ã£o ricos em recursos para a execuÃ§Ã£o da transaÃ§Ã£o.Â Esses nÃ³s de execuÃ§Ã£o foram projetados para manter os dados do estado de execuÃ§Ã£o (estado das contas da flow, contratos inteligentes, recursos etc.) na memÃ³ria para acesso mais rÃ¡pido.Â No entanto, como o estado continuarÃ¡ crescendo indefinidamente, os nÃ³s de execuÃ§Ã£o sÃ£o projetados para manter apenas o estado mais recente na memÃ³ria, voltando a cerca de 100 blocos no passado.Â Portanto, hÃ¡ uma necessidade de uma soluÃ§Ã£o eficiente para atender a dados de estado de execuÃ§Ã£o antigos ou arquivados que remontam a mais de 100 blocos no passado para qualquer aplicativo que gostaria de consultar o estado em um bloco anterior.Â O nÃ³ de arquivo visa fornecer essa soluÃ§Ã£o e servir dados de arquivo.

O nÃ³ de arquivo Ã© um nÃ³ que segue a cadeia e armazena e indexaÂ **o**Â protocolo e o estado de execuÃ§Ã£o.Â Ele permite consultas somente leitura, como a execuÃ§Ã£o de scripts que exigem os valores do registro do estado de execuÃ§Ã£o.Â Ele pode ser usado para responder a quaisquer perguntas de dados anteriores, por exemplo, â€œqual era o saldo da conta Flow na altura X?â€Â onde X Ã© vÃ¡rios milhares de blocos no passado.

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#como-funciona-o-n%C3%B3-de-arquivo)**Como funciona o nÃ³ de arquivo?**

Como o nÃ³ doÂ [observador](https://developers.flow.com/nodes/node-operation/observer-node)Â , o nÃ³ do arquivo tambÃ©m Ã© um nÃ³ nÃ£o stakado e se comunica com um nÃ³ de acesso upstream.Â O nÃ³ observador recebe apenas os dados do estado do protocolo (blocos, coleÃ§Ãµes, transaÃ§Ãµes etc.), enquanto o nÃ³ arquivo recebe tanto o estado do protocolo quanto os dados do estado de execuÃ§Ã£o.

[![](https://assets-global.website-files.com/618c953e65cc2ba3f44d1a02/638fab8a942b81ccc89d304e_Flow%20Diagram\_02-12-22.png)](https://assets-global.website-files.com/618c953e65cc2ba3f44d1a02/638fab8a942b81ccc89d304e_Flow%20Diagram\_02-12-22.png)

â€

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#quem-deve-usar-o-n%C3%B3-de-arquivo)**Quem deve usar o nÃ³ de arquivo?**

*   dApps que precisam de acesso a dados histÃ³ricos, por exemplo,Â [CAST](https://cast.fyi/), que considera os saldos da conta do usuÃ¡rio em um bloco anterior.

*   Ferramentas de anÃ¡lise e auditoria em cadeia que requerem acesso a dados histÃ³ricos.

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#n%C3%B3s-diferentes-para-recupera%C3%A7%C3%A3o-de-dados-n%C3%B3-de-arquivo-vs-n%C3%B3-de-acesso-vs-n%C3%B3-observador)**NÃ³s diferentes para recuperaÃ§Ã£o de dados - nÃ³ de arquivo vs nÃ³ de acesso vs nÃ³ observador**

Antes de discutir a diferenÃ§a entre o nÃ³ de arquivo e os nÃ³s de acesso e observador, primeiro vamos examinar os dois tipos de dados de estado na Blockchain Flow.Â Como a Flow tem diferentes tipos de nÃ³s em vez de um Ãºnico nÃ³ validador, nem todos os tipos de nÃ³s tÃªm todos os dados.Â Os dados de estado da flow sÃ£o divididos em dados deÂ **estado de protocolo**Â e dados deÂ **estado de execuÃ§Ã£o**Â .

Protocol State Ã© o estado de funcionamento do protocolo da rede Flow, incluindo a tabela de identidades e recursos produzidos pelos nÃ³s da rede Flow: blocos, cobranÃ§as, recibos, aprovaÃ§Ãµes, selos, etc.

O estado de execuÃ§Ã£o Ã© o estado das contas da flow, contratos inteligentes, recursos, etc. Esse estado Ã© armazenado integralmente apenas nos nÃ³s de execuÃ§Ã£o.

O nÃ³ de acesso Ã© um nÃ³Â **stakado**Â que recebe e indexa todos os dados de estado do protocolo e atende Ã Â [API de acesso](https://developers.flow.com/nodes/access-api)Â .Â Ele pode responder a todas as chamadas de API do Access relacionadas ao estado do protocolo, como GetBlock, GetAccount, GetCollection etc.

Consultando seu banco de dados local.Â No entanto, para todas as chamadas relacionadas ao estado de execuÃ§Ã£o, por exemplo, GetAccountÂ **,**Â ExecuteScriptAtXXX, ele faz uma chamada upstream para um nÃ³ de execuÃ§Ã£o para buscar os dados do estado de execuÃ§Ã£o.

No inÃ­cio deste ano, o nÃ³ observador foiÂ [lanÃ§ado](https://forum.onflow.org/t/path-to-permissionless-node-operation/3527)Â como uma alternativa nÃ£o stakada ao nÃ³ de acesso que qualquer um pode executar sem ter que stakar o nÃ³.Â Assim como o nÃ³ de acesso, o nÃ³ do observador tambÃ©m atende Ã  API do Access.Â Ele apenas recebe e indexa os dados de bloco mais recentes e delega todas as chamadas de API de acesso a um nÃ³ de acesso upstream diferente daqueles para dados de bloco.

Hoje, pode-se consultar facilmente um nÃ³ de acesso ou um nÃ³ observador para obter o saldo da conta no Ãºltimo bloco ou executar um script no Ãºltimo bloco, mas vocÃª nÃ£o pode consultar o saldo da conta ou executar o script em qualquer bloco arbitrÃ¡rio no passado.

Ao fazer isso, vocÃª receberÃ¡ um erro como o seguinte, pois os nÃ³s de execuÃ§Ã£o nÃ£o retÃªm os dados do estado de execuÃ§Ã£o alÃ©m de 100 blocos no passado.

> erro rpc: code = Desc interno = falha ao obter conta: falha ao obter conta no bloco (xxx): compromisso de estado nÃ£o encontrado (yyy).Â esse erro geralmente ocorre se o bloco de referÃªncia para esse script nÃ£o estiver definido como um bloco recente.

Ã‰ aqui que entra o nÃ³ de arquivo.

Ao contrÃ¡rio do nÃ³ de acesso e do nÃ³ do observador, o nÃ³ de arquivo armazena e indexa o estado de ExecuÃ§Ã£o alÃ©m dos dados de estado do Protocolo.Â 

Em seguida, ele pode responder Ã s chamadas de API de acesso do estado de execuÃ§Ã£o, como GetAccount, por meio de seu banco de dados local.

*   Se vocÃª deseja acessar os Ãºltimos blocos, transaÃ§Ãµes etc., mas nÃ£o deseja executar um nÃ³, use oÂ [nÃ³ de acesso da comunidade Flow](https://developers.flow.com/nodes/access-api#flow-access-node-endpoints)

*   Se vocÃª deseja uma Ãºnica locaÃ§Ã£o e/ou nÃ£o deseja estar sujeito aos limites de taxa da API do Access, considere executar seu prÃ³prio nÃ³ de acesso.

*   Se vocÃª deseja um nÃ³ executado localmente que forneÃ§a os dados de bloco mais recentes, execute um nÃ³ observador.

*   Se vocÃª deseja acessar os dados histÃ³ricos do estado de execuÃ§Ã£o, use o nÃ³ de arquivo da comunidade.

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#api)**API**

O nÃ³ de arquivo fornece uma versÃ£o concisa daÂ [API gRPC Access](https://developers.flow.com/nodes/archive-access-api)Â , que inclui as trÃªs chamadas a seguir:

1.  ExecuteScriptAtBlockID

2.  ExecuteScriptAtBlockHeight

3.  GetAccountAtBlockHeight

Ele retorna um erro HTTP 501 NÃ£o implementado para todas as outras chamadas de API do Access.

O endpoint da API gRPC Ã©: archive.mainnet.nodes.onflow.org:9000

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#exemplos)**Exemplos**

1.  Para obter um saldo de conta no inÃ­cio do spork atual, vocÃª pode chamar GetAccountAtBlockHeight no nÃ³ de arquivo.

CÃ³digo de amostra:

> package main
>
> import (
>
> "context"
>
> "fmt"
>
> "github.com/onflow/flow-go-sdk/access/grpc"
>
> "github.com/onflow/flow-go-sdk"
>
> )
>
> func main() {
>
> // a flow endpoint da API de arquivo da comunidade
>
> archiveNodeAddress := "archive.mainnet.nodes.onflow.org:9000"
>
> // cria um cliente gRPC para o nÃ³ Archive
>
> archiveNodeClient, err := grpc.NewClient(archiveNodeAddress)
>
> if err != nil {
>
> fmt.Println ("err:", err.Error())
>
> panic(err)
>
> }
>
> ctx := context.Background()
>
> addr := flow.HexToAddress("e467b9dd11fa00df") // qualquer endereÃ§o de conta Flow
>
> // obtÃ©m o saldo da conta no inÃ­cio altura do garfo atual
>
> //Â <https://developers.flow.com/nodes/node-operation/past-sporks#mainnet-20>
>
> conta, err := archiveNodeClient.GetAccountAtBlockHeight(ctx, addr, 40171634)
>
> if err != nil {
>
> fmt. Println("err:", err.Error())
>
> panic(err)
>
> }
>
> fmt.Println(account.Balance)
>
> }

â€

1.  Para executar um script em um bloco no passado, vocÃª pode chamar ExecuteScriptAtBlockHeight ou ExecuteScriptAtBlockID no nÃ³ de arquivo.

CÃ³digo de amostra:

> package main
>
> import (
>
> "context"
>
> "fmt"
>
> "github.com/onflow/cadence"
>
> "github.com/onflow/flow-go-sdk/access/grpc"
>
> )
>
> func main() {
>
> // o nÃ³ de acesso da comunidade principal da Flow API endpoint
>
> accessNodeAddress := "access.mainnet.nodes.onflow.org:9000"
>
> // o arquivo da comunidade Flow API endpoint
>
> archiveNodeAddress := "archive.mainnet.nodes.onflow.org:9000"
>
> // cria um cliente gRPC para o NÃ³ de acesso
>
> accessNodeClient, err := grpc.NewClient(accessNodeAddress)
>
> if err != nil {
>
> fmt.Println("err:", err.Error())
>
> panic(err)
>
> }
>
> ctx := context.Background()
>
> // obtÃ©m a altura do Ãºltimo bloco selado do nÃ³ de acesso da comunidade mainnet da Flow RecentBlockHeader
>
> , err := accessNodeClient.GetLatestBlockHeader(ctx, true)
>
> if err != nil {
>
> fmt.Println("err:", err.Error() )
>
> panic(err)
>
> }
>
> // definir a altura para 500 blocos na
>
> altura passada := lastBlockHeader.Height - 500
>
> // criar um cliente gRPC para o nÃ³ Archive
>
> archiveNodeClient, err := grpc.NewClient(archiveNodeAddress)
>
> if err != nil {
>
> fmt.Println("err:", err.Error())
>
> panic(err)
>
> }
>
> script := \[]byte(\`
>
> pub fun main(a: Int): Int {
>
> return a + 10
>
> }
>
> \`)
>
> args := \[]cadence.Value{cadence.NewInt(5)}
>
> // executa o script no nÃ³ de arquivo em uma altura de bloco que Ã© de 500 blocos no
>
> valor passado, err := archiveNodeClient.ExecuteScriptAtBlockHeight(ctx, height, script, args)
>
> if err != nil {
>
> fmt.Println("err:" , err.Error())
>
> panic(err)
>
> }
>
> fmt.Printf("\nValor: %s", valor)
>
> }

â€

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#limita%C3%A7%C3%B5es)**LimitaÃ§Ãµes**

*   [Limites de taxa da API gRPC](https://developers.flow.com/nodes/archive-api-rate-limits)

*   A API REST do Access e o endpoint gRPC-web nÃ£o sÃ£o compatÃ­veis no momento.

*   O nÃ³ de arquivo atualmente nÃ£o pode ser auto-hospedado.

*   O nÃ³ de arquivo sÃ³ pode voltar atÃ© o inÃ­cio do spork atual.

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#status-do-n%C3%B3)**Status do NÃ³**

O status do nÃ³ de arquivo pode ser monitorado naÂ [pÃ¡gina de status da flow](https://status.onflow.org/)Â em â€œComponentes do nÃ³ de arquivo da rede principal da flowâ€

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#o-que-vem-a-seguir)**O que vem a seguir ğŸš€**

Este Ã© um lanÃ§amento beta aberto Ã  medida que resolvemos os problemas e preparamos o nÃ³ de arquivo para um lanÃ§amento GA no inÃ­cio do prÃ³ximo ano.

O nÃ³ de arquivo da comunidade estarÃ¡ sempre disponÃ­vel e, no inÃ­cio do prÃ³ximo ano, haverÃ¡ uma versÃ£oÂ **auto-hospedada**Â do nÃ³ de arquivo que qualquer um pode executar como parte doÂ [caminho para o](https://forum.onflow.org/t/path-to-permissionless-node-operation/3527)Â roteiro de operaÃ§Ã£o do nÃ³ sem permissÃ£o.Â Este lanÃ§amento beta Ã© um trampolim para esse objetivo.

# [](https://www.web3dev.com.br/diegofornalha/versao-beta-aberta-do-no-de-arquivo-da-comunidade-flow-nif?preview=b3b3c9b0a2457f93956d460ffbab01d7036f551d254e3d6b9b7f17ad047db6ca6183e1c6a3a878c809ec12c817f159542051fd489e7fad5070f58d67#coment%C3%A1rios)**ComentÃ¡rios â¤ï¸**

NÃ³s valorizamos o seu feedback.Â Relate quaisquer problemas encontrados ao usar o nÃ³ de arquivo aqui:Â <https://github.com/onflow/flow-archive/issues>.

ConteÃºdo original em inglÃªs aqui:<https://flow.com/post/flow-blockchain-node-operation-archive-node>Parte da Rede da flow (fala com os outros nÃ³s stakados)Qual API ele atende?Qualquer pessoa pode executar um nÃ³?Limites de taxa nos nÃ³s da comunidade

